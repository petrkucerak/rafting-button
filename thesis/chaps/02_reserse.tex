% Lokální makra patří do hlavního souboru, ne sem.
% Tady je mám výjimečně proto, že chci nechat hlavní soubor bez maker,
% která jsou jen pro tento dokument. Uživatelé si pravděpodobně budou
% hlavní soubor kopírovat do svého dokumentu.

\def\ctustyle{{\ssr CTUstyle}}
\def\ttb{\tt\char`\\} % pro tisk kontrolních sekvencí v tabulkách

\chap Rešerše

Druhá kapitola se věnuje trendům technologií aplikovaných v~IoT řešení. Popisuje největší výzvy a~nejčastější problémy, se kterými se v~praxi setkáváme. Dále se zaměřuje na~hierarchickou strukturu IoT sítě.

\sec Vymezení základních pojmů

Než přejdeme k samotné diskuzi problematiky, domnívám se, že je důležité v~rychlosti definovat základní pojmy jako je IoT či Industry 4.0 v~kontextu tohoto projektu. 

\secc Internet věcí

Pojem {\sbf internet věcí} ({\em Internet of Things} či zkráceně IoT) označuje síť fyzických zařízení. Každé zařízení získává data pomocí senzorů nebo zpracovává již naměřená data či ovládá akční člen (např. DC motor). Zařízení si mezi sebou vyměňují informace skrze komunikační síť, jako je např. {\em Internet}.~\cite[hAVBdLOzhCnSEOY2, SGillisMarch2022, PXdJGytMEbmnqOuI]

\secc M2M komunikace

Pojem {\sbf Machine to Machine} komunikace (M2M) označuje bezdrátovou i drátovou komunikaci mezi dvěma a~více zařízeními napřímo bez jakéhokoliv zásahu člověka. {\em M2M} je součástí {\em IoT}.~\cite[eY0fFrRmd7o81s7D]

\secc Industry 4.0

Neexistuje žádná přesná definice pro {\sbf Průmysl 4.0} ({\em Industry 4.0}), která by dle mého názoru objektivně popisovala vše, co se pod tímto pojmem skrývá. Jedná se o stále probíhající období, na~které se nemůžeme dívat s odstupem. Obecně můžeme tvrdit, že při specifikování průmyslu čtvrté generace, se definice shodují v~hlavních rysech~\cite[08phArNgFWqwDwyW, XMxKxj9gwbB0XNh7] popisujících tuto {\em evoluci}:\fnote{Pojem evoluce jsem použil schválně. Chtěl jsem tak poukázat na~to, že z našeho pohledu současné situace se opravdu nejedná o revoluci nýbrž průběžný a~postupný rozvoj technologií.} 

\begitems
* {\sbf Aditivní výroba} (opak obrábění, předmět vzniká přidáváním materiálu\fnote{Více informací na: \url{https://cs.wikipedia.org/wiki/Aditivní_výrobní_proces}}), 
* {\sbf Digitální transformace} (smíšená realita, digitální dvojčata atd.), 
* {\sbf IoT} (síť fyzických zařízení spojující stroje, lidi a~věci), 
* {\sbf Automatizace} s prvky {\sbf AI} a~{\sbf prediktivní analýzy} na~základě naměřených dat, 
* {\sbf Cloud Computing} umožňující horizontální a~vertikální škálování, 
* {\sbf Kybernetická bezpečnost} systémů. 
\enditems

\secc Wireless communication

Pojem {\sbf bezdrátová komunikace} ({\em Wireless communication}) označuje přesun informace z~místa A do místa B jinak než pomocí elektrických či optických vláken. Typicky se jedná o vlnění přenášené prostorem. Jméno a~typ vlnění závisí na~konkrétních parametrech. Nejčastěji se jedná o {\em rádiové vlny}.~\cite[Z7cztCxxD8XEKD0g] 

\sec Trendy ve světě IoT

Zavádění IoT zařízení do denního osobního života a~fungování firem přináší výhody jako je zvýšení efektivity, produktivity a~nutnosti nedělat rutinní věci. Trendem je sbírat co největší množství dat, aby bylo možné data efektivně vytěžit. S tímto trendem souvisí zvyšování množství IoT zařízení, jako jsou například jednoduché MCU se senzorem pro měření jedné veličiny a~modulem pro bezdrátovou komunikaci. 

Takovéto zařízení typicky funguje tak, že se jednou za určitou dobu vzbudí. Pomocí senzoru naměří data, která zpracuje do podoby, aby byla interpretovatelná\fnote{Zpracováním dat je myšleno interpretovat data tak, aby dávala smysl i mimo kontext senzoru. Například při měření vzdálenosti pomocí vířivých proudů je třeba naměřené napětí vyčistit {\em lock-in detekcí} a~kalibrovat, aby vzdálenost byla v~jednotkách délky.} a~data uloží. Následně se data hned odešlou nebo pokračuje zařízení pokračuje ve spánku a~po naměření a~elementárním zpracování většího množství dat, dojde k odeslání do hierarchicky nadřazeného zařízení.\fnote{Gateway či router, které data odesílají dále nebo koncentrátor. Který data ukládá a~dále zpracovává.} K odeslání se obvykle využívá bezdrátového spojení. Po odeslání dat zařízení opět usne a~celý cyklus se opakuje.

Typicky jsou takováto zařízení drobná, lze je umístit na~jakékoliv místo. Jsou optimalizována pro minimální spotřebu energie a~jsou napájena z baterie. Díky tomu nezávisí na~externím zdroji energie.

Aby mohl být popsaný provoz realizován, je nutné všechny vrstvy maximálně optimalizovat pro úsporu energie. Nejvíce dominantní při celém životním cyklu je ve většině případů vysílání zprávy. Při ní je nutné vyzařovat energii. Proto byly navrženy speciální technologické postupy, které pomáhají snížit spotřebu.

Pro základní představu je v~tabulce \ref[RezimCinnosti] specifikována orientační hodnota spotřeby proudu.\fnote{Hodnota proudu není dynamicky specifikována v~závislosti na~čase činnosti. Pro stanovení přesné hodnoty pro spotřebu po dobu $n$ s, by bylo nutné hodnotu vynásobit $n$, kde $[n] = As$.}

\midinsert \clabel[RezimCinnosti]{Orientační hodnoty pro porovnání režimů činností dle spotřeby energie}
\ctable{lr}{
\hfil {\sbf REŽIM ČINNOSTI} & {\sbf SPOTŘEBA} \crl
aktivní provoz (měření, ukládání do paměti, ...) &  $5 mA$\cr
režim vysílání (odesílání, případně příjem dat) & $0.045 A$\cr
režim spánku (čekání vzbuzení) & $1 \mu A$\cr
}
\caption/t Orientační hodnoty pro porovnání režimů činností dle spotřeby energie.
\endinsert

Je možné, že pokrok technologií přinese řešení napájení. Jedna z možných cest je, že MCU bude odebírat potřebnou energii z okolních zdrojů vyzařující elektromagnetickou energii.\fnote{\url{https://cdr.cz/clanek/intel-ukazal-iot-cip-ktery-si-vystaci-s-energii-z-radiovych-vln}} V~současnosti není zvykem takováto zařízení využívat a~ani se nedomnívám, že se jedná o univerzálně využitelné řešení. To především kvůli tomu, že IoT zařízení jsou umístěna i na~místech, kde se nepředpokládá přítomnost dostatečně silného signálu.

\secc Problematika spotřeby energie při bezdrátové komunikaci

Jak bylo výše popsáno, největší energetickou spotřebu na~činnosti IoT zařízení má ve většině případů bezdrátová komunikace, konkrétně vysílání. Při hledání řešení, jak vybudovat síťovou infrastrukturu pro samostatný projekt, jsem se setkal s~řešením této problematiky. Pro moji aplikaci není v~počáteční fázi nikterak kritická. Rozhodl jsem se ale prozkoumat základní technologie, které jsou v~dané oblasti k dispozici. V~podstatě mapují technologie používané pro bezdrátovou komunikaci.

Podle požadavků fungování IoT zařízení je vhodné volit danou technologii. Pokud budou odesílaná data v~desítkách až stovkách bajtů a~zařízení bude nuceno fungovat na~větší vzdálenost, pravděpodobně zvolíme technologie označované jako {\sbf Low~Power~Wide~Area~Network (LPWAN)}. Mezi ně patří například LoRaWAN\fnote{Webové stránky organizace starající se o udržování LoRaWAN \url{https://lora-alliance.org/}.}, Sigfox\fnote{Webové stránky společnosti Sigfox: \url{https://www.sigfox.com/}} nebo NB-IoT.

{\sbf LoRaWAN} je komunikační protokol a~systémová architektura postavená na~technologii LoRa. Zkratka LoRa pochází z anglického {\em long range}, v~překladu tedy dlouhý dosah.~\cite[5iRsAIfGrrlCgt9a] LoRa používá modulaci CSS ({\em chirp spread spectrum}), která rozprostře signál po celém vysílacím kanálu s lineární změnou kmitočtu. LoRa funguje v~pásmech ISM 433, 868 a~915 MHz. LoRaWAN umožňuje tři módy provozu, které se liší podle energetické náročnosti a~počtu přenesených dat.~\cite[3v4SxlByfe8O0HwQ]

{\sbf Sigfox} je francouzská společnost, která se věnuje komunikacím s nízkou spotřebou energie. Poskytují službu Sigfox, která podobně jako LoRaWAN slouží především k sbírání dat z IoT zařízení. Sigfox se v~praxi používá například v~elektroměrech či chytrých pračkách, které jednou za čas odesílají malé množství dat.~\cite[qmBBTvuXC4ZLpzBJ] Na~rozdíl od technologie LoRa používá UNB ({\em Ultra Narrow-Band}). Řešení Sigfox se liší také v~tom, že neumožňuje data odesílat do vlastní infrastruktury, nýbrž je třeba využívat unifikovaný cloud přímo od společnosti.~\cite[PE10ogpYg8hIftSH]

{\sbf Narrowband IoT (NB-IoT)} je technika, kdy úzkopásmová síť využívá již vybudované síťové infrastruktury poskytovatelů mobilní signálu. Pásmo, ve kterém NB-IoT může fungovat, je široké 200 kHz.~\cite[nCK4SoA3nFdVlIqm] Přenosová rychlost se liší dle generace komunikace.\fnote{Detailní přehled jednotlivých typů NB-IoT s informací o přenosové rychlosti: \url{https://en.wikipedia.org/wiki/Narrowband_IoT\#3GPP_LPWAN_standards}.} Trendu užití již vybudovaných IoT síti se budu věnovat v~další kapitole.~\cite[hw9pj8HRl8eVTddM]

\medskip
\clabel[PLWAN-img]{Srovnání parametrů LPWAN technologií}
\picw=22cm \cinspic img/PLWAN.png
\caption/f Srovnání parametrů LPWAN technologií.~\cite[articleLPWAN]
\medskip

Technologie Sigfox vyniká dosahem, pokrytím a~nízkou energetickou náročností. LoRa je stejně jako Sigfox vhodná pro aplikace s požadavkem na~extrémně nízkou energetickou náročnost. Navíc dokáže odeslat více zpráv. NB-IoT nevyniká v~dosahu. Zvládne ale dosahovat mnohem větších přenosových rychlostí, kapacit a~jeho latence je ze všech doposud zmiňovaných technologií, nejnižší.~\cite[articleLPWAN]

Pokud jsou požadavky na~IoT technologii takové, že vyžadujeme vysoce energeticky nenáročnou komunikaci, která je na~malou vzdálenost, připadají v~úvahu především technologie jako Bluetooth, ZigBee či wifi, které jsou definovány v~rodině standardů {\em IEEE 802}.~\cite[znAmft9kik4ksAas] Analogicky podel LPWAN bychom skupinu takových zařízení mohli pojmenovávat jako {\sbf Low~Power~Personal~Area~Network (LPPAN)}.

Fyzická vrstva {\sbf ZigBee} je popsána standardem {\em IEEE 802.15.4}. Jedná se o bezdrátovou komunikaci, která funguje do dosahu 75 m na~frekvencích ISM 868 MHz, 902 - 928 MHz a~2,4 GHz. Pro směrování používá multiskokové {\em ad-hoc} směrovací metody. Díky tomu zvládá dosahovat velkých vzdáleností. Na~rozdíl od Bluetooth jsou jeho typickou aplikací průmyslové senzorové sítě.~\cite[DxrBsa2LTeitnHBJ]

Technologie {\sbf Bluetooth} původně měla nahradit drátové sériové rozhraní {\em RS-232}. Je definovaná standardem {\em IEEE 802.15.1}. Pracuje v~ISM pásmu na~frekvenci 2,4 GHz. Nejnovější verze Bluetooth přenáší data rychlostí až 2 Mbit/s na~vzdálenost 200 m a~velikost zprávy může být až 255 bajtů. Bluetooth se těší veliké oblibě pro komunikaci s drobnou elektronikou, jako jsou například bezdrátová sluchátka, domácí spotřebiče či elektrické hudební nástroje, u kterých umožňuje provádět konfiguraci.~\cite[ayF0F75gllpxRZfL]

{\sbf Wifi} technologie je skupina bezdrátových protokolů, která vychází ze standardu {\em IEEE 802.11}. V~počátcích svého vývoje by se dala nazvat jako dvojče {\em IEEE 802.3} (Ethernet). V~průběhu času nové verze wifi přinášejí novinky, které v~Ethernetu nejsou a~z podstaty ani nikdy nebudou. Wifi funguje v~pásmu ISM 2,4 GHz a~5 GHz.\fnote{Od Wifi-6 i v 6 GHz.}\cite[KHttKelZqh26KWXd] Široká veřejnost zná wifi jako nástroj, který slouží pro komunikaci s Internetem. V~praxi má ale mnohem širší využití.

Zajímavou demonstrací postupných technologických novinek je vývoj wifi jako technologie v~čase.~\cite[3A9RTE39VeKZmCYn] Jednotlivé verze ukazují na~trendy jako je zvyšování výpočetního výkonu a~požadavků na~propustnost sítě. Možnosti protokolů a~vznik speciálních nových protokolů, například i s IoT technologiemi.\fnote{Rychlý průlet verzemi wifi technolgie je například na~webové stránce: \url{https://www.pcmag.com/encyclopedia/term/80211-versions}.}~\cite[KHttKelZqh26KWXd]

Ze všech tří vyjmenovaných technologií rozsahu osobní sítě (PAN) se wifi těší největší oblibě. Dle mého názoru je tato skutečnost způsobena především univerzálností, která pramení z:
\begitems
* rozšíření wifi sítě (77\% domácností v~rámci svého domu nebo bytu rozvádějí wifi pomocí {\em routeru} nebo {\em modemu}\fnote{Hodnoty v~ČR k roku 2022~\cite[1oCHmTbcpJsphbTW]}),
* a~vysokými rychlostmi přenosu a~nízkou latencí.
\enditems
Jak uvádí autoři v~úvodní části \cite[Hlaing2017], výzva je vybudovat robustní ale zároveň energeticky nenáročnou síť. Takovouto aplikaci technologie wifi označujeme pojmeme {\sbf Low-Power Wifi}.

\secc Low-Power Wifi

Pokud se podíváme na~vývoj verzí {\em IEEE 802.11}, je si vhodné položit otázku, jaká verze je pro IoT aplikace nejvíce vhodná. Dle článku~\cite[zFQYZ2ILyLdNVlwM] je {\em 802.11n} (Wifi-4) vhodnější pro aplikaci v~IoT zařízení než {\em 802.11ac} (Wifi-5). Verze {\em 802.11n} totiž nabízí 2 pásma pro komunikaci (2,4 GHz a~5 GHz). Oproti tomu pozdější verze {\em 802.11ac} pouze jeden kanál na~5 GHz. Pro IoT aplikace je užitečnější 2,4 GHz, protože signál lépe proniká materiálem a~má větší dosah. Navíc verze {\em 802.11ac} má vyšší energetickou náročnost, která je způsobena komplikovanějším algoritmem sloužícím k zrychlení přenosu, které je pro většinu IoT aplikací nepotřebné.

Nově do hry také přichází nejnovější verze {\sbf Wifi-6} definovaná ve standardu {\em 802.11ax}. Slibuje hned několik novinek, které by měly IoT zařízením rapidně pomoci.

Nejčastější překážka, kterou v~této práci zmiňuji, je úspora energie. Wifi-6 implementuje {\sbf Target Wait Time (TWT)} mechanismus, který umožňuje IoT zařízení při nečinnosti usnout, a~tak ušetřit značné množství energie (viz \ref[RezimCinnosti]).

Druhou novinkou je {\sbf OFDMA},\fnote{Orthogonal frequency-division multiple access} který umožňuje odesílat stejná data do více zařízení ve stejný čas.

Poslední novinkou, na~kterou bych rád upozornil, je {\sbf BSS coloring}.\fnote{Basic Service Set coloring} Novinka umožňuje {\em obarvit} signál z různých {\em přístupových bodů}, a~tak předejít vzájemnému rušení signálů.~\cite[HarEvenJune25th2020]

\medskip
\clabel[BSS-color-img]{Vizualizace fungování BSS barvení ve Wifi-6}
\picw=15cm \cinspic img/BSS-color.png
\caption/f Vizualizace fungování {\sbf BSS barvení} ve Wifi-6.
\medskip

\secc Optimalizace nízké spotřeby na~zařízení

Energii pro delší fungování zařízení lze především ušetřit správnou volbou MCU a~vhodnou konfigurací. Existuje několik pravidel, které mohou pomoci snížit spotřebu energie a~umožnit IoT zařízení fungovat lépe:

\begitems
* volba vhodného modulu či MCU,
* uvedení zařízení do {\em deep sleep módu},\fnote{Procesor přejde do tzv. {\em deep sleep} módu a~vzbudí se až při zachycení interuptu.}
* vypínání wifi při neaktivitě,
* vhodná optimalizace kódu.
\enditems

Na první pohled by se mohlo zdát, že se vyplatí použít všechna pravidla. To ale nemusí být vždy nejvhodnější řešení. Příkladem může být experiment Přeučila a~Novotného, který demonstroval kombinaci vypínání wifi a~přecházení do {\em deep sleep} módu.~\cite[9797138]

\label[hieearchyStruct]
\sec Struktura sítě

Pro IoT řešení je typická {\sbf hierarchická struktura sítě}. Tato povaha je dána účelem řešení, nejtypičtěji vytěžování dat.

\begitems
* embeded zařízení, senzory, akční členy
* koncentrátory, routery a~gateway
* server, cloud computing
\enditems

{\sbf První úroveň} se stará o měření dat pomocí senzorů, která jsou zpracovávána v~embeded zařízeních nebo o vykonávání činností na~základě přijatých dat.\fnote{Například pomocí generovaného PWM signálu rozsvícení adresovatelné LED diody} V~IoT scénářích se ale častěji jedná o měření. Tato úroveň následně odesílá informace do hierarchicky nadřazené struktury.

{\sbf Druhá úroveň} sbírá data z více embeded zařízení a~zprostředkovává odeslání do úrovně třetí. Data mohou být na~této úrovni i předzpracována. Typická zařízení pro tuto úroveň jsou router, koncentrátor, které bývají vstupní bránou (gateway) do třetí úrovně.

Na {\sbf třetí úrovni} typicky běží server, který může být onpremisového či cloudového charakteru. Výhodou onpremisu je to, že mám zařízení u sebe. To může přinášet ekonomickou či bezpečnostní výhodu. Výhodami cloudu je naopak možné {\em horizontálního} a~{\em vertikální škálování}\fnote{Horizontální škálování znamená přidávání nových instancí. Vertikálním se myslí navyšování a~snižování výkonu.} či {\em Pay As You Go}\fnote{Zaplať, jen co využiješ.} subskripce. Server data zpracovává, ukládá a~připravuje vizualizace pomocí nástrojů, jako jsou například open-source {\em Kibana}\fnote{\url{https://www.elastic.co/kibana/}} a~{\em Grafana}.\fnote{\url{https://grafana.com/}} Kromě vizualizace jsou data na~této úrovni analyzována pomocí algoritmů. Mezi ně může patřit i strojové učení. Cílem je přeměnit data na~znalost, aby je bylo možné interpretovat.

Data jsou přenášena skrz strukturu oběma směry. Pro IoT je ve většině případech spíše vytěžován směr nahoru, respektive z embeded zařízení na~server.


\medskip
\clabel[IoT-structure-img]{Vizualizace typické (hierarchické) struktury IoT projektu}
\picw=15cm \cinspic img/IoT-structure.png
\caption/f Vizualizace typické (hierarchické) struktury IoT projektu.
\medskip